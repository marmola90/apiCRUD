import{j as o,r as h,i as _,K as k,J as U}from"./index-8694ef8d.js";import{b as E,G as H,d as K,c as g,D as q,S as $,e as J,R as G,f as L,h as X,i as z,a as D}from"./DireccionesPrivadas-d8854624.js";import{A as F,r as Q,i as W,d as Y,u as Z,a as x,T as ee,B as se}from"./constants-df63f47f.js";const R=F,te=R+"v1/xnetRoutes/getAllVersionCapturadores",oe=R+"v1/xnetRoutes/insertVersionCapturador",ae=R+"v1/xnetRoutes/updateVersionCapturadores",re=async()=>await fetch(te,{headers:E()}),ie=async n=>{const{TABLA:a,CODIGO:r,DESCRIPCION:i,VERSION:d,ACTIVO:p,LINK:l,SIGLAS:c,LoginPorInstitucion:I,Imagen:u,ReportaDatos:C,AccesoAInstituciones:m,DescripcionHTML:A,AccesoTipoInstitucion:f}=n;return await fetch(oe,{method:"post",headers:E(),body:JSON.stringify({TABLA:a,CODIGO:r,DESCRIPCION:i,VERSION:d,ACTIVO:p,LINK:l,SIGLAS:c,LoginPorInstitucion:I,Imagen:u,ReportaDatos:C,AccesoAInstituciones:m,DescripcionHTML:A,AccesoTipoInstitucion:f})})},ne=async n=>{const{TABLA:a,CODIGO:r,DESCRIPCION:i,VERSION:d,ACTIVO:p,LINK:l,SIGLAS:c,LoginPorInstitucion:I,Imagen:u,ReportaDatos:C,AccesoAInstituciones:m,DescripcionHTML:A,AccesoTipoInstitucion:f}=n;return await fetch(ae,{method:"put",headers:E(),body:JSON.stringify({TABLA:a,CODIGO:r,DESCRIPCION:i,VERSION:d,ACTIVO:p,LINK:l,SIGLAS:c,LoginPorInstitucion:I,Imagen:u,ReportaDatos:C,AccesoAInstituciones:m,DescripcionHTML:A,AccesoTipoInstitucion:f})})};var y={},de=W;Object.defineProperty(y,"__esModule",{value:!0});var w=y.default=void 0,ce=de(Q()),le=o,ue=(0,ce.default)((0,le.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");w=y.default=ue;const he=n=>{const{setRows:a,setRowModesModel:r}=n,i=()=>{a(d=>[{TABLA:"",CODIGO:"",DESCRIPCION:"",VERSION:"",ACTIVO:"",LINK:"",SIGLAS:"",LoginPorInstitucion:!1,Imagen:"",ReportaDatos:!1,AccesoAInstituciones:!1,DescripcionHTML:"",AccesoTipoInstitucion:"",IdOrdenCategoria:0,isNew:!0},...d]),r(d=>({"":{mode:g.Edit,fieldToFocus:"TABLA"},...d}))};return o.jsx(H,{children:o.jsx(Y,{color:"primary",startIcon:o.jsx(K,{}),onClick:i,children:"Agregar Registro"})})},b=[{TABLA:"",CODIGO:"",DESCRIPCION:"",VERSION:"",ACTIVO:"",LINK:"",SIGLAS:"",LoginPorInstitucion:!1,Imagen:"",ReportaDatos:!1,AccesoAInstituciones:!1,DescripcionHTML:"",AccesoTipoInstitucion:""}],me=()=>{const[n,a]=h.useState(b),[r,i]=h.useState({}),d=_(),p=Z(),[l,c]=h.useState(null),[I,u]=h.useState(!1),C=()=>c(null),m=h.useCallback(e=>{c({children:e.message,severity:"error"})},[]),A=(e,s)=>{e.reason===J.rowFocusOut&&(s.defaultMuiPrevented=!0)},f=e=>()=>{i({...r,[e]:{mode:g.Edit}})},S=e=>()=>{i({...r,[e]:{mode:g.View,ignoreModifications:!0}}),n.find(t=>t.CODIGO===e).isNew&&a(n.filter(t=>t.CODIGO!==e))},O=e=>{e===D.SESSION_NO_VALIDA&&(a(b),d(`/${k.LOGIN}`,{replace:!0}),p(U()))},T=e=>()=>{i({...r,[e]:{mode:g.View}})},v=async e=>{await ie(e).then(s=>s.json()).then(s=>{console.log(s),c({children:"User successfully saved",severity:"success"})}).catch(s=>{var N;const t=(N=s.message.match("SESSION_NO_VALIDA"))==null?void 0:N[0];t===D.SESSION_NO_VALIDA&&O(t)})},M=async e=>{await ne(e).then(s=>s.json()).then(s=>{console.log(s),c({children:"User successfully saved",severity:"success"})}).catch(s=>{var N;const t=(N=s.message.match("SESSION_NO_VALIDA"))==null?void 0:N[0];t===D.SESSION_NO_VALIDA&&O(t)})},V=e=>{const s={...e,isNew:!1};return e.isNew?v(e):M(e),a(n.map(t=>t.TABLA===e.TABLA&&t.CODIGO===e.CODIGO?s:t)),s},P=e=>{i(e)},j=[{field:"TABLA",headerName:"Tabla",headerClassName:"headerGrid",editable:!0,type:"string",preProcessEditCellProps:e=>{const s=e.id!==""&&e.props.value!==e.row.TABLA?"Campo llave no se puede modificar":!1;return{...e.props,error:s}},renderEditCell:G},{field:"CODIGO",headerName:"Codigo",width:120,headerClassName:"headerGrid",editable:!0,type:"string",preProcessEditCellProps:e=>{console.log(e);const s=e.id!==""&&e.props.value!==e.row.CODIGO?"Campo llave no se puede modificar":!1;return{...e.props,error:s}},renderEditCell:G},{field:"DESCRIPCION",headerName:"Descripcion",width:170,headerClassName:"headerGrid",editable:!0,type:"string"},{field:"VERSION",headerName:"Version",headerClassName:"headerGrid",editable:!0,type:"string"},{field:"ACTIVO",headerName:"Activo",headerClassName:"headerGrid",editable:!0,type:"string"},{field:"LINK",headerName:"Link",headerClassName:"headerGrid",editable:!0,type:"string"},{field:"SIGLAS",headerName:"Siglas",headerClassName:"headerGrid",editable:!0,type:"string"},{field:"LoginPorInstitucion",headerName:"Login Por Institucion",width:150,headerClassName:"headerGrid",editable:!0,type:"boolean"},{field:"Imagen",headerName:"Imagen",headerClassName:"headerGrid",editable:!0,type:"string"},{field:"ReportaDatos",headerName:"Reporta Datos",width:120,headerClassName:"headerGrid",editable:!0,type:"boolean"},{field:"AccesoAInstituciones",headerName:"Acceso A Instituciones",width:155,headerClassName:"headerGrid",editable:!0,type:"boolean"},{field:"DescripcionHTML",headerName:"Descripcion HTML",width:150,headerClassName:"headerGrid",editable:!0,type:"string"},{field:"AccesoTipoInstitucion",headerName:"Acceso Tipo Institucion",width:160,headerClassName:"headerGrid",editable:!0,type:"string"},{field:"actions",type:"actions",headerName:"Actions ",width:100,cellClassName:"actions",headerClassName:"headerGrid",getActions:({id:e})=>{var t;return((t=r[e])==null?void 0:t.mode)===g.Edit?[o.jsx(L,{icon:o.jsx(X,{}),label:"Save",sx:{color:"primary.main"},onClick:T(e)}),o.jsx(L,{icon:o.jsx(z,{}),label:"Cancel",className:"textPrimary",onClick:S(e),color:"inherit"})]:[o.jsx(L,{icon:o.jsx(w,{sx:{color:"#1d8df8"}}),label:"Edit",className:"textPrimary",onClick:f(e),color:"inherit"})]}}],B=async()=>{await re().then(e=>e.json()).then(e=>{a(e.data),u(!1)}).catch(e=>{const s=e.message.match("SESSION_NO_VALIDA");console.log(e),O(s==null?void 0:s[0])})};return h.useEffect(()=>{u(!0),B();let e=0;console.log(e++)},[]),o.jsx(x,{container:!0,spacing:2,rowSpacing:8,direction:"column",sx:{width:"100em"},children:o.jsxs(x,{item:!0,sx:{width:"100%","& .headerGrid":{backgroundColor:"rgb(14 14 14 / 87%)",color:"white"},"& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary"},"& .css-1j7qk7u":{color:"#fafafa"},"& .css-1pe4mpk-MuiButtonBase-root-MuiIconButton-root":{color:"rgb(245 245 245 / 54%)"}},children:[o.jsx(ee,{variant:"h2",gutterBottom:!0,color:"#353535de",children:"XNET TABLAS"}),o.jsxs(se,{sx:{height:700},children:[o.jsx(q,{columns:j,rows:n,editMode:"row",getRowId:e=>e.TABLA+e.CODIGO,sx:{boxShadow:5},rowModesModel:r,onRowModesModelChange:P,onRowEditStop:A,processRowUpdate:V,onProcessRowUpdateError:m,slots:{toolbar:he},slotProps:{toolbar:{setRows:a,setRowModesModel:i}},loading:I}),!!l&&o.jsx($,{snackbar:l,onClose:C})]})]})})};export{me as default};
