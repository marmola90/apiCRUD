import{r as c,j as n,_ as l,u as A,T as M,a as R,b as y,c as z,G as B,A as N,d as U,i as $,R as V,p as W,e as q,f as b,g as H,h as F,k as G,S as J,l as K,m as Y,n as v,o as Q,C as X,B as g,q as h,P as Z,s as ee,t as _,v as te,w as se}from"./index-6b928391.js";const oe=c.createContext(null),k=oe;function E(){return c.useContext(k)}const ne=typeof Symbol=="function"&&Symbol.for,re=ne?Symbol.for("mui.nested"):"__THEME_NESTED__";function ae(e,t){return typeof t=="function"?t(e):l({},e,t)}function ie(e){const{children:t,theme:s}=e,o=E(),i=c.useMemo(()=>{const a=o===null?s:ae(o,s);return a!=null&&(a[re]=o!==null),a},[s,o]);return n.jsx(k.Provider,{value:i,children:t})}const j={};function C(e,t,s,o=!1){return c.useMemo(()=>{const i=e&&t[e]||t;if(typeof s=="function"){const a=s(i),u=e?l({},t,{[e]:a}):a;return o?()=>u:u}return e?l({},t,{[e]:s}):l({},t,s)},[e,t,s,o])}function ce(e){const{children:t,theme:s,themeId:o}=e,i=A(j),a=E()||j,u=C(o,i,s),d=C(o,a,s,!0);return n.jsx(ie,{theme:d,children:n.jsx(M.Provider,{value:u,children:t})})}const le=["theme"];function ue(e){let{theme:t}=e,s=R(e,le);const o=t[y];return n.jsx(ce,l({},s,{themeId:o?y:void 0,theme:o||t}))}const de=(e,t)=>l({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},t&&!e.vars&&{colorScheme:e.palette.mode}),me=e=>l({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}}),pe=(e,t=!1)=>{var s;const o={};t&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach(([u,d])=>{var m;o[e.getColorSchemeSelector(u).replace(/\s*&/,"")]={colorScheme:(m=d.palette)==null?void 0:m.mode}});let i=l({html:de(e,t),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:l({margin:0},me(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},o);const a=(s=e.components)==null||(s=s.MuiCssBaseline)==null?void 0:s.styleOverrides;return a&&(i=[i,a]),i};function ge(e){const t=z({props:e,name:"MuiCssBaseline"}),{children:s,enableColorScheme:o=!1}=t;return n.jsxs(c.Fragment,{children:[n.jsx(B,{styles:i=>pe(i,o)}),s]})}const he=N,fe=he+"v2/auth/login",ve=async(e,t)=>await fetch(fe,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then(o=>o.json()).catch(o=>o);var x={},xe=$;Object.defineProperty(x,"__esModule",{value:!0});var P=x.default=void 0,Se=xe(U()),ye=n,be=(0,Se.default)((0,ye.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"}),"LockOutlined");P=x.default=be;const _e="/assets/L04-6e10e46d.png",f="user",je=JSON.parse(localStorage.getItem("user")),T={token:null,datos:{Usuario:"",EstaActivo:!1,IDPerfil:V.NA,IDPuestos:W.NA}},Ce=q({name:"user",initialState:localStorage.getItem("user")?je:T,reducers:{createUser:(e,t)=>(b(f,t.payload),t.payload),updateUser:(e,t)=>{const s={...e,...t.payload};return b(f,s),s},resetUser:()=>(H(f),T)}}),{createUser:Te,updateUser:Ae,resetUser:ke}=Ce.actions,Ee=()=>{const e=F(),t=G();return{managesSession:o=>{o===J.SESSION_NO_VALIDA&&(K("currentPage",window.location.href),t(ke()),e(`/${Y.LOGIN}`,{replace:!0}))},navigate:e,dispatch:t}},Pe=c.lazy(()=>v(()=>import("./TextTitle.component-0395c0e3.js"),["assets/TextTitle.component-0395c0e3.js","assets/index-6b928391.js","assets/index-c6741e86.css"])),Ie=c.lazy(()=>v(()=>import("./Backdrop.component-0494403d.js"),["assets/Backdrop.component-0494403d.js","assets/index-6b928391.js","assets/index-c6741e86.css"])),Oe=c.lazy(()=>v(()=>import("./index-6b928391.js").then(e=>e.av),["assets/index-6b928391.js","assets/index-c6741e86.css"])),we=Q(),De={usuario:"",password:""},Me=()=>{const{navigate:e,dispatch:t}=Ee(),[s,o]=c.useState(De),[i,a]=c.useState(null),[u,d]=c.useState(!1),m=sessionStorage.getItem("currentPage"),I=m||`/${se.PRIVATE}`,O=()=>a(null),w=async()=>{try{const r=await ve(s.usuario,s.password);if(console.log({result:r}),r.datos.EstaActivo)t(Te(r)),e(`${I}`,{replace:!0});else{const p=r.datos?!1:JSON.parse(r.token).lde_message;console.log(p),a(p?{children:"Usuario/Contraseña inválidos.",severity:"error"}:{children:"El usuario no esta activo.",severity:"error"}),d(!1)}}catch(r){console.log(r),a({children:r.message,severity:"error"})}},D=async r=>{r.preventDefault(),d(!0),w()},S=r=>{r.preventDefault();const{name:p,value:L}=r.target;o({...s,[p]:L})};return n.jsx(ue,{theme:we,children:n.jsxs(X,{component:"main",sx:{height:"60vh",maxWidth:"100%",width:{xs:"auto",sm:"600px",md:"1050px"},marginTop:"9rem"},children:[n.jsxs(g,{sx:{marginTop:8},children:[n.jsxs(h,{container:!0,children:[n.jsx(ge,{}),n.jsx(h,{item:!0,xs:!1,sm:5,md:7,sx:{backgroundImage:`url(${_e})`,backgroundRepeat:"no-repeat",backgroundColor:r=>r.palette.mode==="light"?r.palette.grey[900]:r.palette.grey[700],backgroundSize:"contain",backgroundPosition:"center"}}),n.jsx(h,{item:!0,xs:12,sm:7,md:5,component:Z,elevation:6,square:!0,children:n.jsxs(g,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[n.jsx(ee,{sx:{m:1,bgcolor:"warning.main"},children:n.jsx(P,{})}),n.jsx(Pe,{variante:"h4",color:"#353535de",titleName:"Sign In"}),n.jsxs(g,{component:"form",onSubmit:D,sx:{mt:1},children:[n.jsx(_,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"usuario",label:"Usuario",name:"usuario",autoComplete:"usuario",onChange:S,autoFocus:!0}),n.jsx(_,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:S}),n.jsx(te,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2,bgcolor:"info.light"},children:"Ingresar"})]})]})})]}),!!i&&n.jsx(Oe,{snackbar:i,onClose:O})]}),n.jsx(Ie,{openBackdrop:u,setOpenBackdrop:d})]})})};export{Me as default};
