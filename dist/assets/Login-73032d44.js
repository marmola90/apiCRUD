import{r as c,j as n,_ as l,u as L,T as A,a as M,b as y,c as R,G as w,A as z,d as B,i as N,R as U,p as $,e as V,f as b,g as W,h as q,k as H,S as F,l as G,m as x,n as J,C as K,B as g,o as h,P as Y,q as Q,s as _,t as X,v as Z}from"./index-17ffd8cd.js";const ee=c.createContext(null),k=ee;function E(){return c.useContext(k)}const te=typeof Symbol=="function"&&Symbol.for,se=te?Symbol.for("mui.nested"):"__THEME_NESTED__";function oe(e,t){return typeof t=="function"?t(e):l({},e,t)}function ne(e){const{children:t,theme:s}=e,o=E(),i=c.useMemo(()=>{const a=o===null?s:oe(o,s);return a!=null&&(a[se]=o!==null),a},[s,o]);return n.jsx(k.Provider,{value:i,children:t})}const j={};function C(e,t,s,o=!1){return c.useMemo(()=>{const i=e&&t[e]||t;if(typeof s=="function"){const a=s(i),u=e?l({},t,{[e]:a}):a;return o?()=>u:u}return e?l({},t,{[e]:s}):l({},t,s)},[e,t,s,o])}function re(e){const{children:t,theme:s,themeId:o}=e,i=L(j),a=E()||j,u=C(o,i,s),d=C(o,a,s,!0);return n.jsx(ne,{theme:d,children:n.jsx(A.Provider,{value:u,children:t})})}const ae=["theme"];function ie(e){let{theme:t}=e,s=M(e,ae);const o=t[y];return n.jsx(re,l({},s,{themeId:o?y:void 0,theme:o||t}))}const ce=(e,t)=>l({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},t&&!e.vars&&{colorScheme:e.palette.mode}),le=e=>l({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}}),ue=(e,t=!1)=>{var s;const o={};t&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach(([u,d])=>{var m;o[e.getColorSchemeSelector(u).replace(/\s*&/,"")]={colorScheme:(m=d.palette)==null?void 0:m.mode}});let i=l({html:ce(e,t),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:l({margin:0},le(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},o);const a=(s=e.components)==null||(s=s.MuiCssBaseline)==null?void 0:s.styleOverrides;return a&&(i=[i,a]),i};function de(e){const t=R({props:e,name:"MuiCssBaseline"}),{children:s,enableColorScheme:o=!1}=t;return n.jsxs(c.Fragment,{children:[n.jsx(w,{styles:i=>ue(i,o)}),s]})}const me=z,pe=me+"v2/auth/login",ge=async(e,t)=>await fetch(pe,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})}).then(o=>o.json()).catch(o=>o);var v={},he=N;Object.defineProperty(v,"__esModule",{value:!0});var P=v.default=void 0,fe=he(B()),xe=n,ve=(0,fe.default)((0,xe.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"}),"LockOutlined");P=v.default=ve;const Se="/assets/L04-6e10e46d.png",f="user",ye=JSON.parse(localStorage.getItem("user")),T={token:null,datos:{Usuario:"",EstaActivo:!1,IDPerfil:U.NA,IDPuestos:$.NA}},be=V({name:"user",initialState:localStorage.getItem("user")?ye:T,reducers:{createUser:(e,t)=>(b(f,t.payload),t.payload),updateUser:(e,t)=>{const s={...e,...t.payload};return b(f,s),s},resetUser:()=>(W(f),T)}}),{createUser:_e,updateUser:De,resetUser:je}=be.actions,Ce=()=>{const e=q(),t=H();return{managesSession:o=>{o===F.SESSION_NO_VALIDA&&(e(`/${G.LOGIN}`,{replace:!0}),t(je()))},navigate:e,dispatch:t}},Te=c.lazy(()=>x(()=>import("./TextTitle.component-8080e7c0.js"),["assets/TextTitle.component-8080e7c0.js","assets/index-17ffd8cd.js","assets/index-3703ef4e.css"])),ke=c.lazy(()=>x(()=>import("./Backdrop.component-77e656b5.js"),["assets/Backdrop.component-77e656b5.js","assets/index-17ffd8cd.js","assets/index-3703ef4e.css"])),Ee=c.lazy(()=>x(()=>import("./index-17ffd8cd.js").then(e=>e.au),["assets/index-17ffd8cd.js","assets/index-3703ef4e.css"])),Pe=J(),Ie={usuario:"",password:""},Le=()=>{const{navigate:e,dispatch:t}=Ce(),[s,o]=c.useState(Ie),[i,a]=c.useState(null),[u,d]=c.useState(!1),m=()=>a(null),I=async()=>{try{const r=await ge(s.usuario,s.password);if(console.log({result:r}),r.datos.EstaActivo)t(_e(r)),e(`/${Z.PRIVATE}`,{replace:!0});else{const p=r.datos?!1:JSON.parse(r.token).lde_message;console.log(p),a(p?{children:"Usuario/Contraseña inválidos.",severity:"error"}:{children:"El usuario no esta activo.",severity:"error"}),d(!1)}}catch(r){console.log(r),a({children:r.message,severity:"error"})}},O=async r=>{r.preventDefault(),d(!0),I()},S=r=>{r.preventDefault();const{name:p,value:D}=r.target;o({...s,[p]:D})};return n.jsx(ie,{theme:Pe,children:n.jsxs(K,{component:"main",sx:{height:"60vh",maxWidth:"100%",width:{xs:"auto",sm:"600px",md:"1050px"},marginTop:"9rem"},children:[n.jsxs(g,{sx:{marginTop:8},children:[n.jsxs(h,{container:!0,children:[n.jsx(de,{}),n.jsx(h,{item:!0,xs:!1,sm:5,md:7,sx:{backgroundImage:`url(${Se})`,backgroundRepeat:"no-repeat",backgroundColor:r=>r.palette.mode==="light"?r.palette.grey[900]:r.palette.grey[700],backgroundSize:"contain",backgroundPosition:"center"}}),n.jsx(h,{item:!0,xs:12,sm:7,md:5,component:Y,elevation:6,square:!0,children:n.jsxs(g,{sx:{my:8,mx:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[n.jsx(Q,{sx:{m:1,bgcolor:"warning.main"},children:n.jsx(P,{})}),n.jsx(Te,{variante:"h4",color:"#353535de",titleName:"Sign In"}),n.jsxs(g,{component:"form",onSubmit:O,sx:{mt:1},children:[n.jsx(_,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"usuario",label:"Usuario",name:"usuario",autoComplete:"usuario",onChange:S,autoFocus:!0}),n.jsx(_,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:S}),n.jsx(X,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2,bgcolor:"info.light"},children:"Ingresar"})]})]})})]}),!!i&&n.jsx(Ee,{snackbar:i,onClose:m})]}),n.jsx(ke,{openBackdrop:u,setOpenBackdrop:d})]})})};export{Le as default};
